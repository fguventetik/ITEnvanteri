<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yeni Cihaz/Lisans Ekle</title> {# Başlık daha genel yapıldı #}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #eef2f7; /* Paneldeki arka plan rengi */
            color: #495057;
            padding-top: 20px;
            padding-bottom: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px; /* Sekmeli form için biraz daha geniş konteyner */
            margin: 20px auto;
        }

        h1 {
            color: #003f7f; /* Ana başlık rengi */
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        /* Bootstrap Alert Stilleri (Flash Mesajları için) */
        .alert {
            margin-bottom: 20px;
        }

        /* Sekme Navigasyonu Stilleri (Bootstrap'in nav-tabs sınıfını kullanacağız) */
        .nav-tabs {
            margin-bottom: 20px; /* Sekme altındaki boşluk */
            border-bottom-color: #dee2e6; /* Alt çizgi rengi */
        }

        .nav-tabs .nav-link {
             color: #495057; /* Sekme yazısı rengi */
             border: 1px solid transparent;
             border-top-left-radius: 0.35rem; /* Hafif yuvarlak köşeler */
             border-top-right-radius: 0.35rem;
             margin-right: 5px;
             transition: color 0.2s ease-in-out, background-color 0.2s ease-in-out, border-color 0.2s ease-in-out;
        }

        .nav-tabs .nav-link:hover {
             border-color: #e9ecef #e9ecef #dee2e6; /* Hover'da kenarlık rengi */
        }

        .nav-tabs .nav-link.active {
            color: #007bff; /* Aktif sekme yazısı rengi */
            background-color: #fff; /* Aktif sekme arka planı */
            border-color: #dee2e6 #dee2e6 #fff; /* Aktif sekme kenarlıkları */
            font-weight: bold;
        }

        /* Form Bölümleri (Sekme İçerikleri) */
        .form-section-content { /* Tüm form bölümlerini sarmalayacak div */
             border: 1px solid #dee2e6;
             padding: 30px; /* İç boşluğu artır */
             border-radius: 0.25rem; /* Hafif yuvarlak köşeler */
             background-color: #fff;
             box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        /* Tablo bazlı form düzenini kaldırdık, Bootstrap form sınıflarını kullanıyoruz */

        .form-label { /* Bootstrap form label sınıfı */
            font-weight: 500;
            margin-bottom: 0.5rem;
            display: block;
            color: #343a40; /* Daha koyu label rengi */
        }

        .form-control, .form-select { /* Bootstrap input/select sınıfları */
            border-radius: 5px;
            padding: 10px 15px;
            border: 1px solid #ced4da;
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }

        .form-control:focus, .form-select:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 0.25rem rgba(0, 123, 255, 0.25);
            outline: none;
        }

        .mb-3 { /* Bootstrap boşluk sınıfı */
            margin-bottom: 1.5rem !important; /* Alanlar arasına daha fazla boşluk */
        }

        /* Form Aksiyonları Bölümü */
        .form-actions {
             margin-top: 30px; /* Sekme içeriklerinden sonra boşluk */
             padding: 20px;
             background-color: #e9ecef; /* Arka plan rengi */
             border-radius: 8px;
             box-shadow: 0 2px 4px rgba(0,0,0,0.05);
             display: flex; /* Elementleri yan yana hizala */
             gap: 20px; /* Elementler arasına boşluk */
             align-items: center; /* Dikeyde ortala */
             flex-wrap: wrap; /* Küçük ekranlarda alt alta */
             justify-content: center; /* Ortala */
        }

        .form-actions label {
             margin-bottom: 0; /* Label'ın alt boşluğunu kaldır */
             font-weight: 500;
             color: #343a40;
        }

        .form-actions .form-control {
             flex-grow: 1; /* Input alanının genişlemesini sağla */
             min-width: 180px; /* Minimum genişlik */
        }


        .btn { /* Tüm butonlar için genel stil */
             padding: 10px 20px;
             font-size: 1.1em;
             font-weight: 500;
             border-radius: 5px;
             transition: background-color 0.3s ease, transform 0.1s ease;
             display: inline-flex; /* İkon ve yazıyı yan yana hizala */
             align-items: center; /* Dikeyde ortala */
        }

        .btn-primary { /* Ekle butonu için primary rengi kullanıldı */
             background-color: #007bff;
             border-color: #007bff;
        }

        .btn-primary:hover {
             background-color: #0056b3;
             border-color: #0056b3;
             transform: translateY(-2px);
        }

         .btn-secondary { /* Geri Dön butonu */
            background-color: #6c757d;
            border-color: #6c757d;
            margin-left: auto; /* Sağ tarafa yasla */
        }

         .btn-secondary:hover {
             background-color: #5a6268;
             border-color: #545b62;
             transform: translateY(-2px);
         }

        .btn i {
            margin-right: 8px; /* Buton içindeki ikon ve yazı arasına boşluk */
        }

         /* Logo Stili */
         .logo {
            display: block; /* Resmi blok yap */
            margin: 0 auto 20px auto; /* Ortala ve altına boşluk ekle */
            max-width: 150px; /* Maksimum genişlik */
            height: auto; /* Oranı koru */
         }


    </style>
</head>
<body>
    <div class="container"> {# Sayfa içeriğini ortalamak için container #}

        {# Flash Mesajları Alanı (Bootstrap Alert) #}
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    {# Kategoriye göre alert sınıfı belirle (success, danger, warning, info) #}
                    <div class="alert alert-{{ category if category != 'message' else 'info' }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <img src="data/logo.png" alt="Logo" class="logo">
        <h1>Envanter Kaydı Ekle</h1> {# Başlık güncellendi #}

        {# Sekme Navigasyonu #}
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <a class="nav-link active" id="bilgisayar-tab" data-bs-toggle="tab" data-bs-target="#bilgisayar_formu_tab" type="button" role="tab" aria-controls="bilgisayar_formu_tab" aria-selected="true">Bilgisayar</a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" id="monitor-tab" data-bs-toggle="tab" data-bs-target="#monitor_formu_tab" type="button" role="tab" aria-controls="monitor_formu_tab" aria-selected="false">Monitör</a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" id="printer-tab" data-bs-toggle="tab" data-bs-target="#printer_formu_tab" type="button" role="tab" aria-controls="printer_formu_tab" aria-selected="false">Yazıcı</a>
            </li>
             <li class="nav-item" role="presentation">
                <a class="nav-link" id="isletim-sistemi-tab" data-bs-toggle="tab" data-bs-target="#isletim_sistemi_formu_tab" type="button" role="tab" aria-controls="isletim_sistemi_formu_tab" aria-selected="false">İşletim Sistemi</a>
            </li>
             <li class="nav-item" role="presentation">
                <a class="nav-link" id="office-tab" data-bs-toggle="tab" data-bs-target="#office_formu_tab" type="button" role="tab" aria-controls="office_formu_tab" aria-selected="false">Office</a>
            </li>
        </ul>

        {# Form İçerikleri (Sekme Panelleri) #}
        <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active form-section-content" id="bilgisayar_formu_tab" role="tabpanel" aria-labelledby="bilgisayar-tab">
                 <form method="POST"> {# Her sekmenin kendi formu olabilir veya dışarıda tek form olabilir. Mevcut yapıya sadık kalmak için her sekme içinde form bırakıldı. #}
                    <input type="hidden" name="cihaz_turu" value="bilgisayar"> {# Gizli alan her forma eklendi #}
                    <div class="mb-3">
                        <label for="bilgisayar_ekipman_kodu" class="form-label">Ekipman Kodu:</label>
                        <input type="text" class="form-control" id="bilgisayar_ekipman_kodu" name="ekipman_kodu">
                    </div>
                    <div class="mb-3">
                        <label for="bilgisayar_tip" class="form-label">Tip:</label>
                        <select class="form-select" id="bilgisayar_tip" name="bilgisayar_tip"> {# form-select sınıfı kullanıldı #}
                            <option value="" disabled selected>Seçiniz</option>
                            <option value="Desktop">Desktop</option>
                            <option value="Laptop">Laptop</option>
                        </select>
                    </div>
                     <div class="mb-3">
                        <label for="bilgisayar_marka" class="form-label">Marka:</label>
                        <select class="form-select" id="bilgisayar_marka" name="bilgisayar_marka">
                             <option value="" disabled selected>Seçiniz</option>
                             {% for marka in bilgisayar_markalari %}
                                 <option value="{{ marka.ad }}">{{ marka.ad }}</option>
                             {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="bilgisayar_model" class="form-label">Model:</label>
                        <input type="text" class="form-control" id="bilgisayar_model" name="bilgisayar_model">
                    </div>
                    <div class="mb-3">
                        <label for="bilgisayar_cpu" class="form-label">CPU:</label>
                        <input type="text" class="form-control" id="bilgisayar_cpu" name="cpu">
                    </div>
                    <div class="mb-3">
                        <label for="bilgisayar_ram" class="form-label">RAM:</label>
                        <input type="text" class="form-control" id="bilgisayar_ram" name="ram">
                    </div>
                    <div class="mb-3">
                        <label for="bilgisayar_disk" class="form-label">Disk:</label>
                        <input type="text" class="form-control" id="bilgisayar_disk" name="disk">
                    </div>
                    {# Kullanıcı alanı ve Ekle butonu artık form-actions div'inde dışarıda #}
                 </form>
            </div>

            <div class="tab-pane fade form-section-content" id="monitor_formu_tab" role="tabpanel" aria-labelledby="monitor-tab">
                 <form method="POST">
                     <input type="hidden" name="cihaz_turu" value="monitor">
                    <div class="mb-3">
                        <label for="monitor_ekipman_kodu" class="form-label">Ekipman Kodu:</label>
                        <input type="text" class="form-control" id="monitor_ekipman_kodu" name="ekipman_kodu">
                    </div>
                    <div class="mb-3">
                        <label for="monitor_boyut" class="form-label">Boyut:</label>
                        <select class="form-select" id="monitor_boyut" name="monitor_boyut">
                             <option value="" disabled selected>Seçiniz</option>
                             {% for boyut in monitor_boyut %}
                                 <option value="{{ boyut.ad }}">{{ boyut.ad }}</option>
                             {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="monitor_tipi" class="form-label">Tip:</label>
                         <select class="form-select" id="monitor_tipi" name="monitor_tipi">
                             <option value="" disabled selected>Seçiniz</option>
                             {% for tip in monitor_tipleri %}
                                 <option value="{{ tip.ad }}">{{ tip.ad }}</option>
                             {% endfor %}
                         </select>
                    </div>
                     <div class="mb-3">
                        <label for="monitor_marka" class="form-label">Marka:</label>
                         <select class="form-select" id="monitor_marka" name="monitor_marka">
                             <option value="" disabled selected>Seçiniz</option>
                             {% for marka in monitor_markalari %}
                                 <option value="{{ marka.ad }}">{{ marka.ad }}</option>
                             {% endfor %}
                         </select>
                    </div>
                    <div class="mb-3">
                        <label for="monitor_model" class="form-label">Model:</label>
                        <input type="text" class="form-control" id="monitor_model" name="monitor_model">
                    </div>
                     <div class="mb-3">
                        <label for="monitor_seri_numarasi" class="form-label">Seri Numarası:</label>
                        <input type="text" class="form-control" id="monitor_seri_numarasi" name="seri_numarasi">
                    </div>
                     {# Kullanıcı alanı ve Ekle butonu form-actions div'inde dışarıda #}
                 </form>
            </div>

            <div class="tab-pane fade form-section-content" id="printer_formu_tab" role="tabpanel" aria-labelledby="printer-tab">
                 <form method="POST">
                     <input type="hidden" name="cihaz_turu" value="yazici">
                     <div class="mb-3">
                        <label for="printer_ekipman_kodu" class="form-label">Ekipman Kodu:</label>
                        <input type="text" class="form-control" id="printer_ekipman_kodu" name="ekipman_kodu">
                    </div>
                    <div class="mb-3">
                        <label for="printer_marka" class="form-label">Marka:</label>
                        <input type="text" class="form-control" id="printer_marka" name="printer_marka">
                    </div>
                    <div class="mb-3">
                        <label for="printer_model" class="form-label">Model:</label>
                        <input type="text" class="form-control" id="printer_model" name="printer_model">
                    </div>
                    <div class="mb-3">
                        <label for="printer_tipi" class="form-label">Tip:</label>
                        <input type="text" class="form-control" id="printer_tipi" name="printer_tipi">
                    </div>
                     <div class="mb-3">
                        <label for="printer_seri_numarasi" class="form-label">Seri Numarası:</label>
                        <input type="text" class="form-control" id="printer_seri_numarasi" name="seri_numarasi">
                    </div>
                     {# Kullanıcı alanı ve Ekle butonu form-actions div'inde dışarıda #}
                 </form>
            </div>

            <div class="tab-pane fade form-section-content" id="isletim_sistemi_formu_tab" role="tabpanel" aria-labelledby="isletim-sistemi-tab">
                 <form method="POST">
                     <input type="hidden" name="cihaz_turu" value="sistem">
                    <div class="mb-3">
                        <label for="sistem_ekipman_kodu" class="form-label">Ekipman Kodu:</label>
                        <input type="text" class="form-control" id="sistem_ekipman_kodu" name="ekipman_kodu">
                    </div>
                    <div class="mb-3">
                        <label for="sistem_versiyon" class="form-label">Sürüm:</label>
                         <select class="form-select" id="sistem_versiyon" name="sistem_versiyon">
                             <option value="" disabled selected>Seçiniz</option>
                             {% for surum in ms_surumler %}
                                 <option value="{{ surum.ad }}">{{ surum.ad }}</option>
                             {% endfor %}
                         </select>
                    </div>
                    <div class="mb-3">
                        <label for="sistem_lisans_no" class="form-label">Lisans No:</label>
                        <input type="text" class="form-control" id="sistem_lisans_no" name="lisans_no">
                    </div>
                    <div class="mb-3">
                        <label for="sistem_lisans_key" class="form-label">Lisans Key:</label>
                        <input type="text" class="form-control" id="sistem_lisans_key" name="lisans_key">
                    </div>
                     {# Kullanıcı alanı ve Ekle butonu form-actions div'inde dışarıda #}
                 </form>
            </div>

             <div class="tab-pane fade form-section-content" id="office_formu_tab" role="tabpanel" aria-labelledby="office-tab">
                 <form method="POST">
                     <input type="hidden" name="cihaz_turu" value="office">
                     <div class="mb-3">
                        <label for="office_ekipman_kodu" class="form-label">Ekipman Kodu:</label>
                        <input type="text" class="form-control" id="office_ekipman_kodu" name="ekipman_kodu">
                    </div>
                    <div class="mb-3">
                        <label for="office_versiyon" class="form-label">Versiyon:</label>
                         <select class="form-select" id="office_versiyon" name="office_versiyon">
                             <option value="" disabled selected>Seçiniz</option>
                             {% for surum in office_surumler %}
                                 <option value="{{ surum.ad }}">{{ surum.ad }}</option>
                             {% endfor %}
                         </select>
                    </div>
                    <div class="mb-3">
                        <label for="office_lisans_no" class="form-label">Lisans No:</label>
                        <input type="text" class="form-control" id="office_lisans_no" name="lisans_no">
                    </div>
                    <div class="mb-3">
                        <label for="office_lisans_key" class="form-label">Lisans Key:</label>
                        <input type="text" class="form-control" id="office_lisans_key" name="lisans_key">
                    </div>
                     {# Kullanıcı alanı ve Ekle butonu form-actions div'inde dışarıda #}
                 </form>
            </div>
        </div>

        {# Kullanıcı Alanı ve Ekle/Geri Dön Butonları - Sekme İçeriklerinin Dışında #}
         <div class="form-actions">
            <label for="kullanici_field" class="form-label mb-0">Kullanıcı:</label> {# mb-0 label'ın altındaki boşluğu kaldırdı #}
            {# name="kullanici" alanını doğrudan formun dışına alamazsınız. Bu alanın form-actions div'inde olması mantıklı. #}
            {# Ancak, bu alanın hangi forma ait olduğu soru işareti yaratır. #}
            {# Ya Kullanıcı alanı her sekmenin içine taşınmalı ya da bu form tek bir form olmalı. #}
            {# Mevcut yapınızda her sekme içinde ayrı <form> etiketleri var. Bu durumda Kullanıcı alanı her formun içine taşınmalı. #}
            {# Veya, tek bir büyük <form> etiketi tüm sekmeleri sarmalamalı ve form actions bu formun içinde olmalı. #}
            {# En yaygın ve önerilen yol: Tek bir form etiketi kullanmak ve form-actions divini bu formun içine koymak. #}
            {# Bu durumda her sekme içindeki <form> etiketlerini kaldırıp, en dışarıdaki tek <form> etiketini kullanacağız. #}
            {# Hidden input'lar yine her sekme içinde olmalı veya JavaScript ile tek forma eklenmeli. JavaScript daha esnek. #}

             {# Önceki HTML'nizde her sekme içinde ayrı form vardı. Bootstrap tab yapısı genellikle tek bir formla çalışır. #}
             {# Tek form yapısına geçildiğinde, JavaScript'in hidden input'u güncellemesi gerekecek. #}
             {# Hidden input'u en dıştaki forma JavaScript ile ekleyelim. #}

            <input type="text" class="form-control" id="kullanici_field" name="kullanici" required>

             <button type="submit" class="btn btn-primary"><i class="fas fa-plus"></i> Ekle</button>
             <a href="{{ url_for('index') }}" class="btn btn-secondary ms-auto"><i class="fas fa-arrow-left"></i> Geri Dön</a> {# Sağ tarafa yaslamak için ms-auto #}

        </div>


    </div>

    {# Bootstrap JS ve Popper.js - Sekme fonksiyonelliği için gerekli #}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Bootstrap'in kendi tab fonksiyonelliğini kullandığımız için,
        // önceki JavaScript'in çoğu Bootstrap JS tarafından hallediliyor.
        // Ancak cihaz_turu hidden inputunu güncellemek için hala JS gerekli.

        const tabLinks = document.querySelectorAll('#myTab .nav-link');
        const form = document.querySelector('.container form'); // Tek form yapısına geçildi

        // Hidden input'u bul veya oluştur
        let hiddenInput = form.querySelector('input[name="cihaz_turu"]');
        if (!hiddenInput) {
             hiddenInput = document.createElement("input");
             hiddenInput.type = "hidden";
             hiddenInput.name = "cihaz_turu";
             form.appendChild(hiddenInput);
        }

        // Sayfa yüklendiğinde aktif sekmenin değerini hidden input'a yaz
        const activeTab = document.querySelector('#myTab .nav-link.active');
        if (activeTab) {
            const targetId = activeTab.getAttribute('data-bs-target').replace('#', '');
            const cihazTuru = targetId.replace("_formu_tab", ""); // ID'den cihaz türünü al
            hiddenInput.value = cihazTuru;
        }


        tabLinks.forEach(tabLink => {
            tabLink.addEventListener('shown.bs.tab', function (event) {
                // Yeni aktif sekmenin ID'sini al
                const targetId = event.target.getAttribute('data-bs-target').replace('#', '');
                // ID'den cihaz türünü çıkar (_formu_tab kısmını kaldır)
                const cihazTuru = targetId.replace("_formu_tab", "");

                // Hidden input'un değerini güncelle
                hiddenInput.value = cihazTuru;

                console.log("Aktif sekme:", cihazTuru); // Konsola yazdırma (opsiyonel)
            });
        });

        // NOT: Orijinal HTML'nizdeki her sekme içindeki <form> etiketlerini kaldırdım.
        // Artık tüm alanlar en dıştaki tek <form> etiketine aittir.
        // Bu, Kullanıcı alanı ve Ekle butonunun formun içinde olmasını sağlar.
        // submit edildiğinde tüm form alanları (aktif sekmedekiler + Kullanıcı alanı) gönderilir.

    </script>

</body>
</html>